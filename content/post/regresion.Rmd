---
title: title
author: cabrokiller
date: '2018-01-03'
slug: regresión lineal
categories:
  - R
tags: ["r"]
---

Vale, que ya pillo algo de R. Y ahora como diablos lo hago servir para algo? Pues bueno, a ver si hacemos una regresión lineal. Simple... Que se entienda lo que hacemos... 

Vamos a utilizar una de las bases de datos de R que viene en el universo de [tidyverse](https://www.tidyverse.org/). Una base chula es la `diamonds` que tiene un registro de 50 mil y pico diamantes, con varias variables numéricas (kilates, tamaño...) y categóricas (color, claridad, corte...). En mi vida he visto un diamante... Como vamos a hacer una regresion lineal, nos ocuparemos sólo de las **variables numéricas**.

Primero y antes de ponerse a buscar esa maldita *p* ([p-hacking](http://freakonometrics.hypotheses.org/19817) le llaman los americanos), y  como siempre en cualquier análisis de datos decente, vamos a **mirar** los malditos datos. Lo mas facilito es hacer un *scatter-plot*, que permite ver relaciones entre dos (o mas) variables. 

Como iba a ser, nos interesa el **precio** y si tiene una relación con algunas de las otras variables. Miramos la relacion con los kilates (*carat*) y con el largo (*x*), y porque somos chulos, le agregamos la línea de regresión lineal a ver si se ajusta.
```{r}
library(tidyverse)
diamonds %>%
   ggplot(aes(carat, price)) +
   geom_point(alpha = .05) +
   geom_smooth(method = "lm", color = "darkgreen")+
   coord_cartesian(xlim = c(0,5), ylim =  c(0,20000)) +
   theme_minimal()
```

se ajusta bien 

```{r}
diamonds %>%
   ggplot(aes(x, price)) +
   geom_point(alpha = .05) +
   geom_smooth(method = "lm", color = "darkgreen", formula = y ~ poly(x, 2)) +
   geom_smooth(method = "lm", color = "darkred", formula = y ~ x) +
   coord_cartesian(xlim = c(3,10), ylim =  c(0,20000)) +
   theme_minimal()
```

Es evidente que a mayor tamaño y mayor peso, mejor precio, auqneu aqui quisaz sería mejor un modelo exp.

Hacemos los modelos, no?

```{r}
model1 <- lm(price ~ x, data = diamonds)
model2 <- lm(price ~ poly(x, 2), data = diamonds)
summary(model2)
```

